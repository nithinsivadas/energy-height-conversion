
% Normalized pitch angle flux
data.ssteflux=cell2mat(sst.eflux)./repmat(sum(cell2mat(sst.eflux)*(22.5/180),2),1,8);
data.sstiflux=cell2mat(sst.iflux)./repmat(sum(cell2mat(sst.iflux)*(22.5/180),2),1,8);
data.esaiflux=cell2mat(esa.iflux)./repmat(sum(cell2mat(esa.iflux)*(22.5/180),2),1,8);
data.esaeflux=cell2mat(esa.eflux)./repmat(sum(cell2mat(esa.eflux)*(22.5/180),2),1,8);
data.pa=cell2mat(sst.epa);

figure;

%  In the form of plot_eflux function

%% SST Electron
data_se.E=10.^(data.ssteflux);
data_se.ebin=data.pa;
data_se.time=sst.etime;

subplot(4,1,1)
plot_eflux(data_se,0.5,'SST e^- PAD');
cmin=0;cmax=1.5;
set(gca,'YScale','linear');
ylabel('Pitch angle in Degrees');
caxis([cmin cmax]);

%% SST Ion
data_si.E=10.^(data.sstiflux);
data_si.ebin=data.pa;
data_si.time=sst.itime;

subplot(4,1,3)
plot_eflux(data_si,0.5,'SST i^+ PAD');
cmin=0;cmax=1.5;
set(gca,'YScale','linear');
ylabel('Pitch angle in Degrees');
caxis([cmin cmax]);

%% ESA Electron
data_ee.E=(10.^data.esaeflux);
data_ee.ebin=data.pa;
data_ee.time=esa.etime;

subplot(4,1,2)
plot_eflux(data_ee,0.5,'ESA e^- PAD');
cmin=0;cmax=1.5;
set(gca,'YScale','linear');
ylabel('Pitch angle in Degrees');
caxis([cmin cmax]);

%% ESA Ion
data_ei.E=10.^(data.esaiflux);
data_ei.ebin=data.pa;
data_ei.time=esa.itime;

subplot(4,1,4)
plot_eflux(data_ei,0.5,'ESA i^+ PAD');
cmin=0;cmax=1.5;
set(gca,'YScale','linear');
ylabel('Pitch angle in Degrees');
caxis([cmin cmax]);

%% SST Ion Anisotropy
figure;plot(sum(data_si.E(:,[3,4,5,6]),2)./sum(data_si.E(:,[1,2,7,8]),2));
ylabel(Eperp/E_parall

