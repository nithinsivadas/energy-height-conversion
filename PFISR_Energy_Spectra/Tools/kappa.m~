function [ phi ] = kappa(E, E0, T, k)
%kappa.m Normalized kappa distribution function for particles with mean energy
%E0,T, and kappa value k.

% Input:
% E  - Energy variable in [eV]
% E0 - Mean energy in [eV]
% T  - Temperature in [K]
% k  - Kappa (unitless)

% Output:
% 

kb = 1.38*10^-23; %Boltzmann Constant
E  = E*1.60218E-19;
E0 = E0*1.60218E-19;

a1 = 4*pi*E0*kb*T*(k-1.5);
a2 = gamma(k)/gamma(k-0.5);
a3 = 1+((E.^0.5 - E0^0.5).^2)/((k-1.5)*kb*T);
a4 = 1+((E.^0.5 + E0^0.5).^2)/((k-1.5)*kb*T);

% No. of particles per Joule of Energy
phi = (a1^-0.5)*a2*(a3.^-k - a4.^-k);  % [J^-1]

% No. of particles per eV
phi = phi*1.60218E-19;                % [eV^-1]

end

