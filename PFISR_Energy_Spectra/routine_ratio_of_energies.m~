% load sample_output_19_may_2016.mat

%% THEMIS

low_t_ebin=32; %30 keV
mid_t_ebin=39; %300 keV
% Splitting into high energy >300 keV and low energy <300 keV
thm_high=sum(data_thm.E(:,mid_t_ebin:end).*repmat(diff(data_thm.ebin(1,(mid_t_ebin-1):end)),187,1),2);
thm_mid =sum(data_thm.E(:,low_t_ebin:mid_t_ebin-1).*repmat(diff(data_thm.ebin(1,low_t_ebin:mid_t_ebin)),187,1),2);
thm_low =sum(data_thm.E(:,1:low_t_ebin-1).*repmat(diff(data_thm.ebin(1,1:low_t_ebin)),187,1),2);

% Splitting in to before onset and after onset
thm_high_B = mean(thm_high(75:114));
thm_high_A = mean(thm_high(146:166));
ratio_thm_high=thm_high_A/thm_high_B

thm_mid_B = mean(thm_mid(75:114));
thm_mid_A = mean(thm_mid(146:166));
ratio_thm_mid=thm_mid_A/thm_mid_B

thm_low_B = mean(thm_low(75:114));
thm_low_A = mean(thm_low(146:166));
ratio_thm_low=thm_low_A/thm_low_B

%% PFISR
low_p_ebin=17; %30 keV
mid_p_ebin=23; %300 keV


% Splitting into high energy >300 keV and low energy <300 keV
pfisr_high=sum(data_pfisr.E(:,mid_p_ebin:end).*repmat(diff(data_pfisr.ebin(1,mid_p_ebin-1:end)),141,1),2);
pfisr_med =sum(data_pfisr.E(:,1:mid_p_ebin-1).*repmat(diff(data_pfisr.ebin(1,1:mid_p_ebin)),141,1),2);
pfisr_low =sum(data_pfisr.E(:,1:22).*repmat(diff(data_pfisr.ebin(1,1:23)),141,1),2);

% Before time: 10:01 AM to 11:13 AM;  After time: 11!:46 UT to 12:17 UT
pfisr_high_B = mean(pfisr_high(57:92));
pfisr_high_A = mean(pfisr_high(108:123));
ratio_pfisr_high=pfisr_high_A/pfisr_high_B

pfisr_low_B = mean(pfisr_low(57:92));
pfisr_low_A = mean(pfisr_low(108:123));
ratio_pfisr_low=pfisr_low_A/pfisr_low_B